WITH last_6_months AS (
    SELECT emp_id, COUNT(*) AS number_of_orders
    FROM orders
    WHERE order_date > CURRENT_DATE - INTERVAL '6 months'
    GROUP BY emp_id
    HAVING COUNT(*) >= 5
), 
total_sales AS (
    SELECT o.emp_id, e.emp_name, SUM(o.sales_value) AS total_sales_value
    FROM orders o
    JOIN employees e ON o.emp_id = e.emp_id
    WHERE o.emp_id IN (SELECT emp_id FROM last_6_months)
    GROUP BY o.emp_id, e.emp_name
)
SELECT ts.emp_id, ts.emp_name, l.number_of_orders, ts.total_sales_value
FROM total_sales ts
JOIN last_6_months l ON ts.emp_id = l.emp_id
ORDER BY ts.total_sales_value DESC
LIMIT 3;